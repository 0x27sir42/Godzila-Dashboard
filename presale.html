<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ZILA Presale</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>

<style>
body { background:#0b1c14; color:white; font-family:Arial; padding:40px }
button, input { padding:12px; margin:8px 0; width:100% }
</style>
</head>

<body>

<h2>ZILA Presale</h2>

<button onclick="connectInjected()">Connect MetaMask / Browser Wallet</button>
<button onclick="connectWalletConnect()">Connect WalletConnect</button>

<br><br>

<input id="pol" placeholder="Min 10 POL">
<button onclick="buy()">Buy ZILA</button>
<button onclick="claim()">Claim ZILA</button>

<p id="status"></p>

<script>
/* ============== CONFIG ============== */
const PRESALE = "0x24CD5fc39Fa409C75f14eB9f2FE25f9cbb324Ffb";

/* ============== STATE ============== */
let provider, signer, account;

/* ============== CONNECT ============== */
async function connectInjected(){
  if(!window.ethereum) return alert("No wallet");
  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts",[]);
  signer = provider.getSigner();
  account = await signer.getAddress();
  status("Connected: "+short(account));
}

async function connectWalletConnect(){
  const wc = new WalletConnectProvider.default({
    rpc:{137:"https://polygon-rpc.com"}
  });
  await wc.enable();
  provider = new ethers.providers.Web3Provider(wc);
  signer = provider.getSigner();
  account = await signer.getAddress();
  status("Connected: "+short(account));
}

/* ============== BUY ============== */
async function buy(){
  if(!account) return alert("Connect wallet");
  const pol = document.getElementById("pol").value;
  if(pol < 10) return alert("Min buy 10 POL");

  const presale = new ethers.Contract(
    PRESALE,
    ["function buy() payable"],
    signer
  );

  const tx = await presale.buy({
    value: ethers.utils.parseEther(pol)
  });

  status("Buy tx: "+tx.hash);
  await tx.wait();
  status("Purchase success");
}

/* ============== CLAIM ============== */
async function claim(){
  const presale = new ethers.Contract(
    PRESALE,
    ["function claim()"],
    signer
  );
  const tx = await presale.claim();
  status("Claim tx: "+tx.hash);
  await tx.wait();
  status("Claim success");
}

function status(t){document.getElementById("status").innerText=t}
function short(a){return a.slice(0,6)+"..."+a.slice(-4)}
</script>

</body>
</html>
