<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ZILA Claim</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>

<style>
body { background:#0b1c14; color:white; font-family:Arial; padding:40px }
button { padding:12px 20px; margin:10px 0; font-size:16px }
</style>
</head>

<body>

<h2>Claim Rewards</h2>

<button onclick="connectInjected()">Connect MetaMask / Browser Wallet</button>
<br>
<button onclick="connectWalletConnect()">Connect WalletConnect (QR)</button>
<br><br>
<button onclick="claimRewards()">Claim Rewards</button>

<p id="status"></p>

<script>
/* =========================
   CONFIG
========================= */
const STAKING_CONTRACT = "0x69862631A0E37dDCc22F3ba5153ca12BB0934B43";

/* =========================
   STATE
========================= */
let provider;
let signer;
let account;

/* =========================
   INJECTED WALLET
========================= */
async function connectInjected() {
  if (!window.ethereum) {
    alert("No injected wallet found");
    return;
  }

  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  signer = provider.getSigner();
  account = await signer.getAddress();

  document.getElementById("status").innerText =
    "Connected (Injected): " + account;
}

/* =========================
   WALLETCONNECT
========================= */
async function connectWalletConnect() {
  const wcProvider = new WalletConnectProvider.default({
    rpc: {
      137: "https://polygon-rpc.com"
    }
  });

  await wcProvider.enable();

  provider = new ethers.providers.Web3Provider(wcProvider);
  signer = provider.getSigner();
  account = await signer.getAddress();

  document.getElementById("status").innerText =
    "Connected (WalletConnect): " + account;
}

/* =========================
   CLAIM
========================= */
async function claimRewards() {
  if (!account) {
    alert("Connect wallet first");
    return;
  }

  const staking = new ethers.Contract(
    STAKING_CONTRACT,
    ["function claim()"],
    signer
  );

  const tx = await staking.claim();
  document.getElementById("status").innerText =
    "Tx sent: " + tx.hash;

  await tx.wait();
  document.getElementById("status").innerText =
    "Claim success";
}
</script>

</body>
</html>
