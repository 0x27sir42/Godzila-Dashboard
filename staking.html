<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ZILA Staking</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>

<style>
body { background:#0b1c14; color:white; font-family:Arial; padding:40px }
button, input, select { padding:12px; margin:8px 0; width:100% }
</style>
</head>

<body>

<h2>ZILA Staking</h2>

<button onclick="connectInjected()">Connect MetaMask / Browser Wallet</button>
<button onclick="connectWalletConnect()">Connect WalletConnect</button>

<br><br>

<select id="lock">
  <option value="90">3 Months – 2% APR</option>
  <option value="365">12 Months – 10% APR</option>
</select>

<input id="amount" placeholder="Min 10,000 ZILA">

<button onclick="stake()">Stake ZILA</button>
<button onclick="claim()">Claim Rewards</button>

<p id="status"></p>

<script>
/* ================= CONFIG ================= */
const TOKEN = "0xE54c126BfE1cdA9A347F2a35DFAc5a9ca155f9A9";
const STAKING = "0x69862631A0E37dDCc22F3ba5153ca12BB0934B43";

/* ================= STATE ================= */
let provider, signer, account;

/* ================= CONNECT ================= */
async function connectInjected(){
  if(!window.ethereum) return alert("No wallet found");
  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  signer = provider.getSigner();
  account = await signer.getAddress();
  status("Connected: "+short(account));
}

async function connectWalletConnect(){
  const wc = new WalletConnectProvider.default({
    rpc:{137:"https://polygon-rpc.com"}
  });
  await wc.enable();
  provider = new ethers.providers.Web3Provider(wc);
  signer = provider.getSigner();
  account = await signer.getAddress();
  status("Connected: "+short(account));
}

/* ================= STAKE ================= */
async function stake(){
  if(!account) return alert("Connect wallet");
  const amt = document.getElementById("amount").value;
  if(amt < 10000) return alert("Min staking 10,000 ZILA");

  const token = new ethers.Contract(
    TOKEN,
    ["function approve(address,uint256)"],
    signer
  );

  const staking = new ethers.Contract(
    STAKING,
    ["function stake(uint256,uint256)"],
    signer
  );

  const value = ethers.utils.parseUnits(amt,18);
  await token.approve(STAKING,value);
  const tx = await staking.stake(value, document.getElementById("lock").value);
  status("Staking tx: "+tx.hash);
  await tx.wait();
  status("Staking success");
}

/* ================= CLAIM ================= */
async function claim(){
  if(!account) return alert("Connect wallet");
  const staking = new ethers.Contract(
    STAKING,
    ["function claim()"],
    signer
  );
  const tx = await staking.claim();
  status("Claim tx: "+tx.hash);
  await tx.wait();
  status("Claim success");
}

function status(t){document.getElementById("status").innerText=t}
function short(a){return a.slice(0,6)+"..."+a.slice(-4)}
</script>

</body>
</html>
