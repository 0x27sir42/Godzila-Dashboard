<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ZILA Web3 DApp</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- STYLE -->
<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#0b0f14;
  color:#fff;
}

.navbar{
  position:fixed;
  top:0;
  width:100%;
  background:#111;
  display:flex;
  align-items:center;
  padding:10px;
  z-index:1000;
}

.navbar a{
  color:#fff;
  margin-right:15px;
  text-decoration:none;
}

.navbar button{
  margin-left:auto;
  padding:8px 14px;
  background:#00ff9c;
  border:none;
  cursor:pointer;
  font-weight:bold;
}

.container{
  padding-top:80px;
  max-width:420px;
  margin:auto;
}

.card{
  background:#151a21;
  padding:20px;
  border-radius:10px;
  margin-bottom:30px;
}

input,select,button{
  width:100%;
  padding:10px;
  margin-top:10px;
  border-radius:6px;
  border:none;
}

button.action{
  background:#00ff9c;
  font-weight:bold;
}
</style>

<!-- ETHERS -->
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
</head>

<body>

<!-- NAVBAR -->
<div class="navbar">
  <a href="#">Home</a>
  <a href="#presale">Presale</a>
  <a href="#staking">Staking</a>
  <a href="#claim">Claim</a>
  <a href="#tokenomics">Tokenomics</a>
  <a href="#whitepaper">Whitepaper</a>
  <button class="connectBtn" onclick="connectWallet()">Connect Wallet</button>
</div>

<div class="container">

<!-- PRESALE -->
<div id="presale" class="card">
  <h2>Presale</h2>
  <input id="polAmount" placeholder="POL amount" oninput="calcZila()">
  <p>You receive: <b><span id="zilaAmount">0</span> ZILA</b></p>
  <button class="action" onclick="buyZila()">Buy ZILA</button>
</div>

<!-- STAKING -->
<div id="staking" class="card">
  <h2>Staking</h2>

  <select id="lock">
    <option value="90">3 Months – 2% APR</option>
    <option value="365">12 Months – 10% APR</option>
  </select>

  <input id="stakeAmount" placeholder="ZILA amount (min 10000)">
  <button class="action" onclick="stakeZila()">Stake</button>
</div>

<!-- CLAIM -->
<div id="claim" class="card">
  <h2>Claim Rewards</h2>
  <button class="action" onclick="claimRewards()">Claim</button>
</div>

</div>

<!-- SCRIPT -->
<script>
let provider;
let signer;
let userAccount = null;

// ===== CONNECT WALLET (FIX TOTAL) =====
async function connectWallet(){
  if(!window.ethereum){
    alert("Install MetaMask / Trust Wallet");
    return;
  }

  try{
    const accounts = await window.ethereum.request({
      method:"eth_requestAccounts"
    });

    await window.ethereum.request({
      method:"wallet_switchEthereumChain",
      params:[{chainId:"0x89"}] // Polygon
    });

    provider = new ethers.providers.Web3Provider(window.ethereum);
    signer = provider.getSigner();
    userAccount = accounts[0];

    document.querySelectorAll(".connectBtn").forEach(btn=>{
      btn.innerText = userAccount.slice(0,6)+"..."+userAccount.slice(-4);
      btn.disabled = true;
    });

  }catch(err){
    if(err.code===4001){
      alert("Connection rejected");
    }else{
      alert("Wallet connection failed");
    }
  }
}

// ===== PRESALE =====
const RATE = 1560;

function calcZila(){
  const pol = Number(document.getElementById("polAmount").value||0);
  document.getElementById("zilaAmount").innerText = pol * RATE;
}

function buyZila(){
  if(!userAccount) return alert("Connect wallet first");
  alert("Presale tx will be sent via smart contract");
}

// ===== STAKING =====
function stakeZila(){
  if(!userAccount) return alert("Connect wallet first");

  const amt = Number(document.getElementById("stakeAmount").value);
  if(amt < 10000) return alert("Minimum staking is 10,000 ZILA");

  alert("Staking tx will be sent");
}

// ===== CLAIM =====
function claimRewards(){
  if(!userAccount) return alert("Connect wallet first");
  alert("Claim transaction sent");
}
</script>

</body>
</html>
